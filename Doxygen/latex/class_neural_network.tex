\hypertarget{class_neural_network}{}\doxysection{Класс Neural\+Network}
\label{class_neural_network}\index{NeuralNetwork@{NeuralNetwork}}


{\ttfamily \#include $<$Neural\+Network.\+h$>$}

\doxysubsection*{Открытые члены}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_neural_network_accce4a7728e89a009a9d4ca1758c9b9d}{Neural\+Network}} ()
\item 
\mbox{\hyperlink{class_neural_network_a2427bc1b8752a1c1d5aec7dbe1364b2c}{Neural\+Network}} (\mbox{\hyperlink{class_r_n_g}{RNG}} \&rng)
\item 
\mbox{\hyperlink{class_neural_network_a65475a7d7b05d302392333302626b2f8}{$\sim$\+Neural\+Network}} ()
\item 
unsigned long \mbox{\hyperlink{class_neural_network_a741eef5530cbbf605423a73ccfc0bea4}{count\+\_\+layers}} () const
\begin{DoxyCompactList}\small\item\em Подсчет кол-\/ва слоев \end{DoxyCompactList}\item 
Matrix \mbox{\hyperlink{class_neural_network_af02c7fecdc06b95e0363b701206d4cc8}{get\+\_\+last\+\_\+hidden\+\_\+layer}} () const
\begin{DoxyCompactList}\small\item\em Получить последний скрытый слой для подсчета метрик классификации. Используется в Classification\+Callback \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_neural_network_a9c93c9359d97a972a9f5217844232515}{add\+\_\+layer}} (\mbox{\hyperlink{class_layer}{Layer}} $\ast$layer)
\begin{DoxyCompactList}\small\item\em Добавить слой в сетку \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_neural_network_a3381186802b58d23489e13bb6946a8c6}\label{class_neural_network_a3381186802b58d23489e13bb6946a8c6}} 
void {\bfseries set\+\_\+output} (\mbox{\hyperlink{class_output}{Output}} $\ast$output)
\item 
const \mbox{\hyperlink{class_output}{Output}} $\ast$ \mbox{\hyperlink{class_neural_network_a7686eabf1c59519eda1bc3ca1ce9628e}{get\+\_\+output}} () const
\begin{DoxyCompactList}\small\item\em None \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_neural_network_a2b386e9db77b77839fee7414709832d4}{set\+\_\+callback}} (\mbox{\hyperlink{class_callback}{Callback}} \&callback)
\begin{DoxyCompactList}\small\item\em Установить пользовательский вывод информации про обучение сетки. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_neural_network_af75afc0507cbb73ef2026bcdc3dff8fd}{set\+\_\+default\+\_\+callback}} ()
\begin{DoxyCompactList}\small\item\em Установить дефолтный вывод. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_neural_network_a1fc1b272357d05d428ff56dd3d9baaff}{init}} (const Scalar \&mu=Scalar(0), const Scalar \&sigma=Scalar(0.\+01), int seed=-\/1)
\begin{DoxyCompactList}\small\item\em Инициализация слоев сетки. Первая генерация весов сетки
\begin{DoxyItemize}
\item значения из нормального распределения. 
\end{DoxyItemize}\end{DoxyCompactList}\item 
{\footnotesize template$<$typename DerivedX , typename DerivedY $>$ }\\bool \mbox{\hyperlink{class_neural_network_aa2610807f00844077ab61934577b7b52}{fit}} (\mbox{\hyperlink{class_optimizer}{Optimizer}} \&opt, const Eigen\+::\+Matrix\+Base$<$ DerivedX $>$ \&x, const Eigen\+::\+Matrix\+Base$<$ DerivedY $>$ \&y, int batch\+\_\+size, int epoch, int seed=-\/1)
\begin{DoxyCompactList}\small\item\em Начать обучение сетки \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_neural_network_a9df496ee112c5db84fdda8dd2e07def5}\label{class_neural_network_a9df496ee112c5db84fdda8dd2e07def5}} 
Matrix {\bfseries predict} (const Matrix \&x)
\item 
std\+::vector$<$ std\+::vector$<$ Scalar $>$ $>$ \mbox{\hyperlink{class_neural_network_a623867db76a7e2e4f5e9549882b5898e}{get\+\_\+parameters}} () const
\begin{DoxyCompactList}\small\item\em Получить параметры сетки \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_neural_network_a1fb4700cb175ea0899d4ba6230c4ad8e}{set\+\_\+parameters}} (const std\+::vector$<$ std\+::vector$<$ Scalar $>$ $>$ \&param)
\begin{DoxyCompactList}\small\item\em Установить пользовательские параметры сетки \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::vector$<$ Scalar $>$ $>$ \mbox{\hyperlink{class_neural_network_a6b9ed2f41de3a9380fc90577a5a17089}{get\+\_\+derivatives}} () const
\begin{DoxyCompactList}\small\item\em Получить производные всех слоев \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_neural_network_aebf5e70cf5ed0729bcb87f4af72ea6f8}\label{class_neural_network_aebf5e70cf5ed0729bcb87f4af72ea6f8}} 
void {\bfseries export\+\_\+net} (std\+::string folder, std\+::string filename) const
\end{DoxyCompactItemize}
\doxysubsection*{Друзья}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{class_neural_network_ae90d363c1f302b0cba3149e2c4cb7a57}\label{class_neural_network_ae90d363c1f302b0cba3149e2c4cb7a57}} 
std\+::ostream \& {\bfseries operator$<$$<$} (std\+::ostream \&output, \mbox{\hyperlink{class_neural_network}{Neural\+Network}} \&obj)
\end{DoxyCompactItemize}


\doxysubsection{Подробное описание}
Этот модуль описывает интерфейс нейронной сети, которая будет использоваться пользователем 

\doxysubsection{Конструктор(ы)}
\mbox{\Hypertarget{class_neural_network_accce4a7728e89a009a9d4ca1758c9b9d}\label{class_neural_network_accce4a7728e89a009a9d4ca1758c9b9d}} 
\index{NeuralNetwork@{NeuralNetwork}!NeuralNetwork@{NeuralNetwork}}
\index{NeuralNetwork@{NeuralNetwork}!NeuralNetwork@{NeuralNetwork}}
\doxysubsubsection{\texorpdfstring{NeuralNetwork()}{NeuralNetwork()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily Neural\+Network\+::\+Neural\+Network (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Стандартный конструктор \mbox{\Hypertarget{class_neural_network_a2427bc1b8752a1c1d5aec7dbe1364b2c}\label{class_neural_network_a2427bc1b8752a1c1d5aec7dbe1364b2c}} 
\index{NeuralNetwork@{NeuralNetwork}!NeuralNetwork@{NeuralNetwork}}
\index{NeuralNetwork@{NeuralNetwork}!NeuralNetwork@{NeuralNetwork}}
\doxysubsubsection{\texorpdfstring{NeuralNetwork()}{NeuralNetwork()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily Neural\+Network\+::\+Neural\+Network (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_r_n_g}{RNG}} \&}]{rng }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [explicit]}}

Конструктор при передаче другого генератора \mbox{\Hypertarget{class_neural_network_a65475a7d7b05d302392333302626b2f8}\label{class_neural_network_a65475a7d7b05d302392333302626b2f8}} 
\index{NeuralNetwork@{NeuralNetwork}!````~NeuralNetwork@{$\sim$NeuralNetwork}}
\index{````~NeuralNetwork@{$\sim$NeuralNetwork}!NeuralNetwork@{NeuralNetwork}}
\doxysubsubsection{\texorpdfstring{$\sim$NeuralNetwork()}{~NeuralNetwork()}}
{\footnotesize\ttfamily Neural\+Network\+::$\sim$\+Neural\+Network (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Деструктор, удаляем из памяти все слои 

\doxysubsection{Методы}
\mbox{\Hypertarget{class_neural_network_a9c93c9359d97a972a9f5217844232515}\label{class_neural_network_a9c93c9359d97a972a9f5217844232515}} 
\index{NeuralNetwork@{NeuralNetwork}!add\_layer@{add\_layer}}
\index{add\_layer@{add\_layer}!NeuralNetwork@{NeuralNetwork}}
\doxysubsubsection{\texorpdfstring{add\_layer()}{add\_layer()}}
{\footnotesize\ttfamily void Neural\+Network\+::add\+\_\+layer (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_layer}{Layer}} $\ast$}]{layer }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Добавить слой в сетку 


\begin{DoxyParams}{Аргументы}
{\em layer} & -\/ указатель на слой\\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{class_neural_network_a741eef5530cbbf605423a73ccfc0bea4}\label{class_neural_network_a741eef5530cbbf605423a73ccfc0bea4}} 
\index{NeuralNetwork@{NeuralNetwork}!count\_layers@{count\_layers}}
\index{count\_layers@{count\_layers}!NeuralNetwork@{NeuralNetwork}}
\doxysubsubsection{\texorpdfstring{count\_layers()}{count\_layers()}}
{\footnotesize\ttfamily unsigned long Neural\+Network\+::count\+\_\+layers (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Подсчет кол-\/ва слоев 

\begin{DoxyReturn}{Возвращает}

\end{DoxyReturn}
\mbox{\Hypertarget{class_neural_network_aa2610807f00844077ab61934577b7b52}\label{class_neural_network_aa2610807f00844077ab61934577b7b52}} 
\index{NeuralNetwork@{NeuralNetwork}!fit@{fit}}
\index{fit@{fit}!NeuralNetwork@{NeuralNetwork}}
\doxysubsubsection{\texorpdfstring{fit()}{fit()}}
{\footnotesize\ttfamily template$<$typename DerivedX , typename DerivedY $>$ \\
bool Neural\+Network\+::fit (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_optimizer}{Optimizer}} \&}]{opt,  }\item[{const Eigen\+::\+Matrix\+Base$<$ DerivedX $>$ \&}]{x,  }\item[{const Eigen\+::\+Matrix\+Base$<$ DerivedY $>$ \&}]{y,  }\item[{int}]{batch\+\_\+size,  }\item[{int}]{epoch,  }\item[{int}]{seed = {\ttfamily -\/1} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Начать обучение сетки 


\begin{DoxyTemplParams}{Параметры шаблона}
{\em DerivedX} & \\
\hline
{\em DerivedY} & \\
\hline
\end{DoxyTemplParams}

\begin{DoxyParams}{Аргументы}
{\em opt} & -\/ оптимизатор\\
\hline
{\em x} & -\/ вектор для обучения\\
\hline
{\em y} & -\/ таргет\\
\hline
{\em batch\+\_\+size} & -\/ размер батча\\
\hline
{\em epoch} & -\/ кол-\/во эпох при обучении сетки\\
\hline
{\em seed} & -\/ сид для генерации случайных чисел\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Возвращает}
True если все прошло хорошо
\end{DoxyReturn}
\mbox{\Hypertarget{class_neural_network_a6b9ed2f41de3a9380fc90577a5a17089}\label{class_neural_network_a6b9ed2f41de3a9380fc90577a5a17089}} 
\index{NeuralNetwork@{NeuralNetwork}!get\_derivatives@{get\_derivatives}}
\index{get\_derivatives@{get\_derivatives}!NeuralNetwork@{NeuralNetwork}}
\doxysubsubsection{\texorpdfstring{get\_derivatives()}{get\_derivatives()}}
{\footnotesize\ttfamily std\+::vector$<$ std\+::vector$<$Scalar$>$ $>$ Neural\+Network\+::get\+\_\+derivatives (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Получить производные всех слоев 

\begin{DoxyReturn}{Возвращает}

\end{DoxyReturn}
\mbox{\Hypertarget{class_neural_network_af02c7fecdc06b95e0363b701206d4cc8}\label{class_neural_network_af02c7fecdc06b95e0363b701206d4cc8}} 
\index{NeuralNetwork@{NeuralNetwork}!get\_last\_hidden\_layer@{get\_last\_hidden\_layer}}
\index{get\_last\_hidden\_layer@{get\_last\_hidden\_layer}!NeuralNetwork@{NeuralNetwork}}
\doxysubsubsection{\texorpdfstring{get\_last\_hidden\_layer()}{get\_last\_hidden\_layer()}}
{\footnotesize\ttfamily Matrix Neural\+Network\+::get\+\_\+last\+\_\+hidden\+\_\+layer (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Получить последний скрытый слой для подсчета метрик классификации. Используется в Classification\+Callback 

\begin{DoxyReturn}{Возвращает}

\end{DoxyReturn}
\mbox{\Hypertarget{class_neural_network_a7686eabf1c59519eda1bc3ca1ce9628e}\label{class_neural_network_a7686eabf1c59519eda1bc3ca1ce9628e}} 
\index{NeuralNetwork@{NeuralNetwork}!get\_output@{get\_output}}
\index{get\_output@{get\_output}!NeuralNetwork@{NeuralNetwork}}
\doxysubsubsection{\texorpdfstring{get\_output()}{get\_output()}}
{\footnotesize\ttfamily const \mbox{\hyperlink{class_output}{Output}}$\ast$ Neural\+Network\+::get\+\_\+output (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



None 

\begin{DoxyReturn}{Возвращает}
Получить выходной слой
\end{DoxyReturn}
\mbox{\Hypertarget{class_neural_network_a623867db76a7e2e4f5e9549882b5898e}\label{class_neural_network_a623867db76a7e2e4f5e9549882b5898e}} 
\index{NeuralNetwork@{NeuralNetwork}!get\_parameters@{get\_parameters}}
\index{get\_parameters@{get\_parameters}!NeuralNetwork@{NeuralNetwork}}
\doxysubsubsection{\texorpdfstring{get\_parameters()}{get\_parameters()}}
{\footnotesize\ttfamily std\+::vector$<$ std\+::vector$<$Scalar$>$ $>$ Neural\+Network\+::get\+\_\+parameters (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Получить параметры сетки 

\begin{DoxyReturn}{Возвращает}

\end{DoxyReturn}
\mbox{\Hypertarget{class_neural_network_a1fc1b272357d05d428ff56dd3d9baaff}\label{class_neural_network_a1fc1b272357d05d428ff56dd3d9baaff}} 
\index{NeuralNetwork@{NeuralNetwork}!init@{init}}
\index{init@{init}!NeuralNetwork@{NeuralNetwork}}
\doxysubsubsection{\texorpdfstring{init()}{init()}}
{\footnotesize\ttfamily void Neural\+Network\+::init (\begin{DoxyParamCaption}\item[{const Scalar \&}]{mu = {\ttfamily Scalar(0)},  }\item[{const Scalar \&}]{sigma = {\ttfamily Scalar(0.01)},  }\item[{int}]{seed = {\ttfamily -\/1} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Инициализация слоев сетки. Первая генерация весов сетки
\begin{DoxyItemize}
\item значения из нормального распределения. 
\end{DoxyItemize}


\begin{DoxyParams}{Аргументы}
{\em mu} & -\/ мат. ожидание нормального распределения.\\
\hline
{\em sigma} & -\/ дисперсия нормального распределения.\\
\hline
{\em seed} & -\/ сид для рандома.\\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{class_neural_network_a2b386e9db77b77839fee7414709832d4}\label{class_neural_network_a2b386e9db77b77839fee7414709832d4}} 
\index{NeuralNetwork@{NeuralNetwork}!set\_callback@{set\_callback}}
\index{set\_callback@{set\_callback}!NeuralNetwork@{NeuralNetwork}}
\doxysubsubsection{\texorpdfstring{set\_callback()}{set\_callback()}}
{\footnotesize\ttfamily void Neural\+Network\+::set\+\_\+callback (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_callback}{Callback}} \&}]{callback }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Установить пользовательский вывод информации про обучение сетки. 


\begin{DoxyParams}{Аргументы}
{\em callback} & -\/ ссылка на объект класса, который будет здесь работать.\\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{class_neural_network_af75afc0507cbb73ef2026bcdc3dff8fd}\label{class_neural_network_af75afc0507cbb73ef2026bcdc3dff8fd}} 
\index{NeuralNetwork@{NeuralNetwork}!set\_default\_callback@{set\_default\_callback}}
\index{set\_default\_callback@{set\_default\_callback}!NeuralNetwork@{NeuralNetwork}}
\doxysubsubsection{\texorpdfstring{set\_default\_callback()}{set\_default\_callback()}}
{\footnotesize\ttfamily void Neural\+Network\+::set\+\_\+default\+\_\+callback (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Установить дефолтный вывод. 

\mbox{\Hypertarget{class_neural_network_a1fb4700cb175ea0899d4ba6230c4ad8e}\label{class_neural_network_a1fb4700cb175ea0899d4ba6230c4ad8e}} 
\index{NeuralNetwork@{NeuralNetwork}!set\_parameters@{set\_parameters}}
\index{set\_parameters@{set\_parameters}!NeuralNetwork@{NeuralNetwork}}
\doxysubsubsection{\texorpdfstring{set\_parameters()}{set\_parameters()}}
{\footnotesize\ttfamily void Neural\+Network\+::set\+\_\+parameters (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ std\+::vector$<$ Scalar $>$ $>$ \&}]{param }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Установить пользовательские параметры сетки 


\begin{DoxyParams}{Аргументы}
{\em param} & -\/ матрица параметров\\
\hline
\end{DoxyParams}


Объявления и описания членов класса находятся в файле\+:\begin{DoxyCompactItemize}
\item 
/home/shuffle/xs\+DNN/xs\+DNN-\/include/neuralnetwork/Neural\+Network.\+h\end{DoxyCompactItemize}
