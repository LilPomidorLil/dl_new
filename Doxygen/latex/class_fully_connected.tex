\hypertarget{class_fully_connected}{}\doxysection{Шаблон класса Fully\+Connected$<$ Activation $>$}
\label{class_fully_connected}\index{FullyConnected$<$ Activation $>$@{FullyConnected$<$ Activation $>$}}


Граф наследования\+:Fully\+Connected$<$ Activation $>$\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=244pt]{class_fully_connected__inherit__graph}
\end{center}
\end{figure}


Граф связей класса Fully\+Connected$<$ Activation $>$\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=244pt]{class_fully_connected__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Открытые члены}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_fully_connected_a0279654be206e4ac68781641a4268eff}{Fully\+Connected}} (const int in\+\_\+size, const int out\+\_\+size, bool bias\+\_\+true\+\_\+false=true)
\item 
\mbox{\Hypertarget{class_fully_connected_a826a01dff0b93b28a1a2461b835805b0}\label{class_fully_connected_a826a01dff0b93b28a1a2461b835805b0}} 
void {\bfseries init} (const Scalar \&mu, const Scalar \&sigma, RNG \&rng) override
\item 
\mbox{\Hypertarget{class_fully_connected_ac3b2e13ebb5e01f40264ae2f284acfdb}\label{class_fully_connected_ac3b2e13ebb5e01f40264ae2f284acfdb}} 
void {\bfseries init} () override
\item 
void \mbox{\hyperlink{class_fully_connected_a353890c868d804fdd4413391e47ddbf2}{forward}} (const Matrix \&prev\+\_\+layer\+\_\+data) override
\item 
const Matrix \& \mbox{\hyperlink{class_fully_connected_ad48e07203091863a70eeab8067e9a874}{output}} () override
\item 
void \mbox{\hyperlink{class_fully_connected_a41796b96e30579ff95bb431a790a0278}{backprop}} (const Matrix \&prev\+\_\+layer\+\_\+data, const Matrix \&next\+\_\+layer\+\_\+data) override
\item 
const Matrix \& \mbox{\hyperlink{class_fully_connected_ac086387a0d735269ff18d129520cdd73}{backprop\+\_\+data}} () const override
\item 
void \mbox{\hyperlink{class_fully_connected_af2902ec5488f74f16a655a91bb0a4387}{update}} (Optimizer \&opt) override
\item 
std\+::vector$<$ Scalar $>$ \mbox{\hyperlink{class_fully_connected_a8a486eb0b003a733f3c151caff4d407d}{get\+\_\+parametrs}} () const override
\item 
void \mbox{\hyperlink{class_fully_connected_a77310b597d8105994fbb8af8fb9d4183}{set\+\_\+parametrs}} (const std\+::vector$<$ Scalar $>$ \&param) override
\item 
std\+::vector$<$ Scalar $>$ \mbox{\hyperlink{class_fully_connected_aceb34071f12aba98136a9b5b8f2275dc}{get\+\_\+derivatives}} () const override
\item 
std\+::string \mbox{\hyperlink{class_fully_connected_ae7a92b8c80cded3869a4f3951a61ea7b}{layer\+\_\+type}} () const override
\item 
std\+::string \mbox{\hyperlink{class_fully_connected_a9b70f2ba5a4fa5ec8dbaf942a975a749}{activation\+\_\+type}} () const override
\item 
void \mbox{\hyperlink{class_fully_connected_af0eb3a46ee512b93d8c594288647cbe9}{fill\+\_\+meta\+\_\+info}} (Meta \&map, int index) const override
\end{DoxyCompactItemize}


\doxysubsection{Конструктор(ы)}
\mbox{\Hypertarget{class_fully_connected_a0279654be206e4ac68781641a4268eff}\label{class_fully_connected_a0279654be206e4ac68781641a4268eff}} 
\index{FullyConnected$<$ Activation $>$@{FullyConnected$<$ Activation $>$}!FullyConnected@{FullyConnected}}
\index{FullyConnected@{FullyConnected}!FullyConnected$<$ Activation $>$@{FullyConnected$<$ Activation $>$}}
\doxysubsubsection{\texorpdfstring{FullyConnected()}{FullyConnected()}}
{\footnotesize\ttfamily template$<$typename Activation $>$ \\
\mbox{\hyperlink{class_fully_connected}{Fully\+Connected}}$<$ Activation $>$\+::\mbox{\hyperlink{class_fully_connected}{Fully\+Connected}} (\begin{DoxyParamCaption}\item[{const int}]{in\+\_\+size,  }\item[{const int}]{out\+\_\+size,  }\item[{bool}]{bias\+\_\+true\+\_\+false = {\ttfamily true} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Конструктор полносвязного слоя 
\begin{DoxyParams}{Аргументы}
{\em in\+\_\+size} & кол-\/во нейронов на вход. \\
\hline
{\em out\+\_\+size} & кол-\/во нейронов на выход. \\
\hline
{\em bias\+\_\+true\+\_\+false} & включить / выключить смещения весов. По умолч. включены = true. \\
\hline
\end{DoxyParams}


\doxysubsection{Методы}
\mbox{\Hypertarget{class_fully_connected_a9b70f2ba5a4fa5ec8dbaf942a975a749}\label{class_fully_connected_a9b70f2ba5a4fa5ec8dbaf942a975a749}} 
\index{FullyConnected$<$ Activation $>$@{FullyConnected$<$ Activation $>$}!activation\_type@{activation\_type}}
\index{activation\_type@{activation\_type}!FullyConnected$<$ Activation $>$@{FullyConnected$<$ Activation $>$}}
\doxysubsubsection{\texorpdfstring{activation\_type()}{activation\_type()}}
{\footnotesize\ttfamily template$<$typename Activation $>$ \\
std\+::string \mbox{\hyperlink{class_fully_connected}{Fully\+Connected}}$<$ Activation $>$\+::activation\+\_\+type (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}

\begin{DoxyReturn}{Возвращает}
Название функции активации. Activation\+::return\+\_\+type() 
\end{DoxyReturn}
\mbox{\Hypertarget{class_fully_connected_a41796b96e30579ff95bb431a790a0278}\label{class_fully_connected_a41796b96e30579ff95bb431a790a0278}} 
\index{FullyConnected$<$ Activation $>$@{FullyConnected$<$ Activation $>$}!backprop@{backprop}}
\index{backprop@{backprop}!FullyConnected$<$ Activation $>$@{FullyConnected$<$ Activation $>$}}
\doxysubsubsection{\texorpdfstring{backprop()}{backprop()}}
{\footnotesize\ttfamily template$<$typename Activation $>$ \\
void \mbox{\hyperlink{class_fully_connected}{Fully\+Connected}}$<$ Activation $>$\+::backprop (\begin{DoxyParamCaption}\item[{const Matrix \&}]{prev\+\_\+layer\+\_\+data,  }\item[{const Matrix \&}]{next\+\_\+layer\+\_\+data }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}

Получаем производные этого слоя. Нужно получить производные по 3 вещам.
\begin{DoxyEnumerate}
\item Производные весов -\/ считаем Якобиан и умножаем на предыдущий слой
\item Производные смещения -\/ среднее по строкам производных весов
\item Производные текущих значений нейронов -\/ текущий вес на Якобиан. Предыдущий / следующий слой считается слева направо. 
\begin{DoxyParams}{Аргументы}
{\em prev\+\_\+layer\+\_\+data} & значения нейронов предыдущего слоя \\
\hline
{\em next\+\_\+layer\+\_\+data} & значения нейронов следующего слоя \\
\hline
\end{DoxyParams}

\end{DoxyEnumerate}\mbox{\Hypertarget{class_fully_connected_ac086387a0d735269ff18d129520cdd73}\label{class_fully_connected_ac086387a0d735269ff18d129520cdd73}} 
\index{FullyConnected$<$ Activation $>$@{FullyConnected$<$ Activation $>$}!backprop\_data@{backprop\_data}}
\index{backprop\_data@{backprop\_data}!FullyConnected$<$ Activation $>$@{FullyConnected$<$ Activation $>$}}
\doxysubsubsection{\texorpdfstring{backprop\_data()}{backprop\_data()}}
{\footnotesize\ttfamily template$<$typename Activation $>$ \\
const Matrix\& \mbox{\hyperlink{class_fully_connected}{Fully\+Connected}}$<$ Activation $>$\+::backprop\+\_\+data (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}

\begin{DoxyReturn}{Возвращает}
Вектор направления спуска (антиградиент) 
\end{DoxyReturn}
\mbox{\Hypertarget{class_fully_connected_af0eb3a46ee512b93d8c594288647cbe9}\label{class_fully_connected_af0eb3a46ee512b93d8c594288647cbe9}} 
\index{FullyConnected$<$ Activation $>$@{FullyConnected$<$ Activation $>$}!fill\_meta\_info@{fill\_meta\_info}}
\index{fill\_meta\_info@{fill\_meta\_info}!FullyConnected$<$ Activation $>$@{FullyConnected$<$ Activation $>$}}
\doxysubsubsection{\texorpdfstring{fill\_meta\_info()}{fill\_meta\_info()}}
{\footnotesize\ttfamily template$<$typename Activation $>$ \\
void \mbox{\hyperlink{class_fully_connected}{Fully\+Connected}}$<$ Activation $>$\+::fill\+\_\+meta\+\_\+info (\begin{DoxyParamCaption}\item[{Meta \&}]{map,  }\item[{int}]{index }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}

Формирование словаря с полным описанием слоя для выгрузки/загрузки сети 
\begin{DoxyParams}{Аргументы}
{\em map} & словарь \\
\hline
{\em index} & индекс слоя в общей сети. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{class_fully_connected_a353890c868d804fdd4413391e47ddbf2}\label{class_fully_connected_a353890c868d804fdd4413391e47ddbf2}} 
\index{FullyConnected$<$ Activation $>$@{FullyConnected$<$ Activation $>$}!forward@{forward}}
\index{forward@{forward}!FullyConnected$<$ Activation $>$@{FullyConnected$<$ Activation $>$}}
\doxysubsubsection{\texorpdfstring{forward()}{forward()}}
{\footnotesize\ttfamily template$<$typename Activation $>$ \\
void \mbox{\hyperlink{class_fully_connected}{Fully\+Connected}}$<$ Activation $>$\+::forward (\begin{DoxyParamCaption}\item[{const Matrix \&}]{prev\+\_\+layer\+\_\+data }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}

Описание того, как толкаются данные по сетке внутри одного слоя. Сначала получаем значения нейронов просто перемножая веса и предыдущие значения нейронов. Добавляем к этому смещение, если необходимо. Активируем. 
\begin{DoxyParams}{Аргументы}
{\em prev\+\_\+layer\+\_\+data} & матрица значений нейронов предыдущего слоя \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{class_fully_connected_aceb34071f12aba98136a9b5b8f2275dc}\label{class_fully_connected_aceb34071f12aba98136a9b5b8f2275dc}} 
\index{FullyConnected$<$ Activation $>$@{FullyConnected$<$ Activation $>$}!get\_derivatives@{get\_derivatives}}
\index{get\_derivatives@{get\_derivatives}!FullyConnected$<$ Activation $>$@{FullyConnected$<$ Activation $>$}}
\doxysubsubsection{\texorpdfstring{get\_derivatives()}{get\_derivatives()}}
{\footnotesize\ttfamily template$<$typename Activation $>$ \\
std\+::vector$<$Scalar$>$ \mbox{\hyperlink{class_fully_connected}{Fully\+Connected}}$<$ Activation $>$\+::get\+\_\+derivatives (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}

\begin{DoxyReturn}{Возвращает}
Производные весов и смещений (если необходимо). 
\end{DoxyReturn}
\mbox{\Hypertarget{class_fully_connected_a8a486eb0b003a733f3c151caff4d407d}\label{class_fully_connected_a8a486eb0b003a733f3c151caff4d407d}} 
\index{FullyConnected$<$ Activation $>$@{FullyConnected$<$ Activation $>$}!get\_parametrs@{get\_parametrs}}
\index{get\_parametrs@{get\_parametrs}!FullyConnected$<$ Activation $>$@{FullyConnected$<$ Activation $>$}}
\doxysubsubsection{\texorpdfstring{get\_parametrs()}{get\_parametrs()}}
{\footnotesize\ttfamily template$<$typename Activation $>$ \\
std\+::vector$<$Scalar$>$ \mbox{\hyperlink{class_fully_connected}{Fully\+Connected}}$<$ Activation $>$\+::get\+\_\+parametrs (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}

\begin{DoxyReturn}{Возвращает}
Параметры слоя. Со смещением или без взависимости от условия. 
\end{DoxyReturn}
\mbox{\Hypertarget{class_fully_connected_ae7a92b8c80cded3869a4f3951a61ea7b}\label{class_fully_connected_ae7a92b8c80cded3869a4f3951a61ea7b}} 
\index{FullyConnected$<$ Activation $>$@{FullyConnected$<$ Activation $>$}!layer\_type@{layer\_type}}
\index{layer\_type@{layer\_type}!FullyConnected$<$ Activation $>$@{FullyConnected$<$ Activation $>$}}
\doxysubsubsection{\texorpdfstring{layer\_type()}{layer\_type()}}
{\footnotesize\ttfamily template$<$typename Activation $>$ \\
std\+::string \mbox{\hyperlink{class_fully_connected}{Fully\+Connected}}$<$ Activation $>$\+::layer\+\_\+type (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}

\begin{DoxyReturn}{Возвращает}
Название слоя. 
\end{DoxyReturn}
\mbox{\Hypertarget{class_fully_connected_ad48e07203091863a70eeab8067e9a874}\label{class_fully_connected_ad48e07203091863a70eeab8067e9a874}} 
\index{FullyConnected$<$ Activation $>$@{FullyConnected$<$ Activation $>$}!output@{output}}
\index{output@{output}!FullyConnected$<$ Activation $>$@{FullyConnected$<$ Activation $>$}}
\doxysubsubsection{\texorpdfstring{output()}{output()}}
{\footnotesize\ttfamily template$<$typename Activation $>$ \\
const Matrix\& \mbox{\hyperlink{class_fully_connected}{Fully\+Connected}}$<$ Activation $>$\+::output (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}

\begin{DoxyReturn}{Возвращает}
Значения нейронов после активации 
\end{DoxyReturn}
\mbox{\Hypertarget{class_fully_connected_a77310b597d8105994fbb8af8fb9d4183}\label{class_fully_connected_a77310b597d8105994fbb8af8fb9d4183}} 
\index{FullyConnected$<$ Activation $>$@{FullyConnected$<$ Activation $>$}!set\_parametrs@{set\_parametrs}}
\index{set\_parametrs@{set\_parametrs}!FullyConnected$<$ Activation $>$@{FullyConnected$<$ Activation $>$}}
\doxysubsubsection{\texorpdfstring{set\_parametrs()}{set\_parametrs()}}
{\footnotesize\ttfamily template$<$typename Activation $>$ \\
void \mbox{\hyperlink{class_fully_connected}{Fully\+Connected}}$<$ Activation $>$\+::set\+\_\+parametrs (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ Scalar $>$ \&}]{param }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}

Установить параметры сетки. Используется при загрузки сети из файла. 
\begin{DoxyParams}{Аргументы}
{\em param} & 1-\/D вектор параметров. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{class_fully_connected_af2902ec5488f74f16a655a91bb0a4387}\label{class_fully_connected_af2902ec5488f74f16a655a91bb0a4387}} 
\index{FullyConnected$<$ Activation $>$@{FullyConnected$<$ Activation $>$}!update@{update}}
\index{update@{update}!FullyConnected$<$ Activation $>$@{FullyConnected$<$ Activation $>$}}
\doxysubsubsection{\texorpdfstring{update()}{update()}}
{\footnotesize\ttfamily template$<$typename Activation $>$ \\
void \mbox{\hyperlink{class_fully_connected}{Fully\+Connected}}$<$ Activation $>$\+::update (\begin{DoxyParamCaption}\item[{Optimizer \&}]{opt }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}

Обновление весов и смещений используя переданный алгоритм оптимизации (см. Optimizer) 
\begin{DoxyParams}{Аргументы}
{\em opt} & оптимайзер. Объект класса, унаследованного от Optimizer. \\
\hline
\end{DoxyParams}


Объявления и описания членов класса находятся в файле\+:\begin{DoxyCompactItemize}
\item 
/home/shuffle/xs\+DNN/xs\+DNN-\/include/neuralnetwork/\+Layer/Fully\+Connected.\+h\end{DoxyCompactItemize}
