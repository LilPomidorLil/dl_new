<mxfile host="app.diagrams.net" modified="2022-10-20T21:41:40.191Z" agent="5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.124 YaBrowser/22.9.3.894 Yowser/2.5 Safari/537.36" etag="SGbufw3Vf4yGMUU5p1RX" version="20.4.2" type="github" pages="9">
  <diagram name="xsdnn::main" id="efa7a0a1-bf9b-a30e-e6df-94a7791c09e9">
    <mxGraphModel dx="1300" dy="802" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="2339" pageHeight="3300" background="none" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="3jrJSmBCQ7t12A0o4Kmw-114" value="&lt;p style=&quot;margin: 0px; margin-top: 4px; text-align: center; text-decoration: underline;&quot;&gt;&lt;strong&gt;ClassName&lt;/strong&gt;&lt;/p&gt;&lt;hr&gt;&lt;p style=&quot;margin: 0px; margin-left: 8px;&quot;&gt;Field&#39;s:&lt;/p&gt;&lt;p style=&quot;margin: 0px; margin-left: 8px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px; margin-left: 8px;&quot;&gt;Method&#39;s:&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;strokeColor=#003366;shadow=1;fillColor=#D4E1F5;fontColor=#003366" parent="1" vertex="1">
          <mxGeometry x="2090" y="120" width="160" height="140" as="geometry" />
        </mxCell>
        <mxCell id="3jrJSmBCQ7t12A0o4Kmw-115" value="&lt;h1&gt;Слой&lt;/h1&gt;&lt;p&gt;Базовый класс &lt;b&gt;layer &lt;/b&gt;для всех слоев&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;text-align: center;&quot;&gt;//&lt;i&gt;TODO&lt;/i&gt;:&amp;nbsp; подумать, нужно ли использовать &lt;b&gt;node&lt;/b&gt; и наследовать &lt;b&gt;layer&lt;/b&gt; от него? Предварительно: нет, тк &lt;b&gt;tiny&lt;/b&gt;-&lt;b&gt;dnn&lt;/b&gt; использует &lt;b&gt;node&lt;/b&gt; и &lt;b&gt;edge&lt;/b&gt; как собственные контейнеры. У меня будет реализовано через &lt;b&gt;Eigen::TensorBase&lt;/b&gt;&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="40" y="10" width="190" height="250" as="geometry" />
        </mxCell>
        <mxCell id="3jrJSmBCQ7t12A0o4Kmw-116" value="&lt;h1&gt;Template&lt;/h1&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="2100" y="50" width="190" height="50" as="geometry" />
        </mxCell>
        <mxCell id="3jrJSmBCQ7t12A0o4Kmw-117" value="&lt;p style=&quot;margin: 0px; margin-top: 4px; text-align: center; text-decoration: underline;&quot;&gt;&lt;b&gt;xsdnn::layer&lt;/b&gt;&lt;/p&gt;&lt;hr&gt;&lt;p style=&quot;margin: 0px; margin-left: 8px;&quot;&gt;Field&#39;s:&lt;/p&gt;&lt;p style=&quot;margin: 0px; margin-left: 8px;&quot;&gt;protected:&lt;/p&gt;&lt;p style=&quot;margin: 0px; margin-left: 8px;&quot;&gt;bool initialized_ # layer init?&lt;/p&gt;&lt;p style=&quot;margin: 0px; margin-left: 8px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px; margin-left: 8px;&quot;&gt;private:&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 8px;&quot;&gt;bool trainable_&amp;nbsp; &amp;nbsp;# update grad?&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 8px;&quot;&gt;weight_init # инициализатор весов&lt;/p&gt;&lt;p style=&quot;margin: 0px 0px 0px 8px;&quot;&gt;bias_init # инициализатор смещений&lt;/p&gt;&lt;p style=&quot;margin: 0px; margin-left: 8px;&quot;&gt;TensorBase? fwd_in_data_&lt;/p&gt;&lt;p style=&quot;margin: 0px; margin-left: 8px;&quot;&gt;TensorBase? fwd_out_data_&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px; margin-left: 8px;&quot;&gt;TensorBase? bwd_in_data_&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px; margin-left: 8px;&quot;&gt;TensorBase? bwd_in_grad_&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px; margin-left: 8px;&quot;&gt;TensorBase? bwd_out_data_&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px; margin-left: 8px;&quot;&gt;TensorBase? bwd_out_grad_&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px; margin-left: 8px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px; margin-left: 8px;&quot;&gt;Method&#39;s:&lt;/p&gt;&lt;p style=&quot;margin: 0px; margin-left: 8px;&quot;&gt;&lt;a href=&quot;data:page/id,acLyr5f8MV2qwVlqdKkI&quot;&gt;&lt;font face=&quot;ui-monospace, SFMono-Regular, SF Mono, Menlo, Consolas, Liberation Mono, monospace&quot; color=&quot;#d2a8ff&quot; style=&quot;background-color: rgb(0, 0, 0);&quot;&gt;forward&lt;/font&gt;&lt;/a&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px; margin-left: 8px;&quot;&gt;&lt;a href=&quot;data:page/id,P51iXEZZl-BP7aw9WZGj&quot;&gt;&lt;font face=&quot;ui-monospace, SFMono-Regular, SF Mono, Menlo, Consolas, Liberation Mono, monospace&quot; color=&quot;#d2a8ff&quot; style=&quot;background-color: rgb(0, 0, 0);&quot;&gt;forward_propagation&lt;/font&gt;&lt;/a&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px; margin-left: 8px;&quot;&gt;&lt;a href=&quot;data:page/id,9vZ8QekkStvvB2-BGn0U&quot;&gt;&lt;font face=&quot;ui-monospace, SFMono-Regular, SF Mono, Menlo, Consolas, Liberation Mono, monospace&quot; color=&quot;#d2a8ff&quot; style=&quot;background-color: rgb(0, 0, 0);&quot;&gt;backward&lt;/font&gt;&lt;/a&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px; margin-left: 8px;&quot;&gt;&lt;a href=&quot;data:page/id,YzGOiIOgP3fO_uxTNOQc&quot;&gt;&lt;font face=&quot;ui-monospace, SFMono-Regular, SF Mono, Menlo, Consolas, Liberation Mono, monospace&quot; color=&quot;#d2a8ff&quot; style=&quot;background-color: rgb(0, 0, 0);&quot;&gt;back_propagation&lt;/font&gt;&lt;/a&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px; margin-left: 8px;&quot;&gt;&lt;span style=&quot;font-family: ui-monospace, SFMono-Regular, &amp;quot;SF Mono&amp;quot;, Menlo, Consolas, &amp;quot;Liberation Mono&amp;quot;, monospace; background-color: rgb(13, 17, 23);&quot;&gt;&lt;a style=&quot;&quot; href=&quot;data:page/id,1ntwXYWYcS74xLM6uAJB&quot;&gt;&lt;font color=&quot;#d2a8ff&quot;&gt;update_weight&lt;/font&gt;&lt;/a&gt;&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px; margin-left: 8px;&quot;&gt;&lt;a style=&quot;background-color: rgb(0, 0, 0);&quot; href=&quot;data:page/id,imFPhnd7Cz6RNdqDAHEO&quot;&gt;&lt;font face=&quot;ui-monospace, SFMono-Regular, SF Mono, Menlo, Consolas, Liberation Mono, monospace&quot; color=&quot;#d2a8ff&quot;&gt;weight_init&lt;/font&gt;&lt;/a&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px; margin-left: 8px;&quot;&gt;&lt;a style=&quot;background-color: rgb(0, 0, 0);&quot; href=&quot;data:page/id,p6dzrHT5QFA6u9v4Chr_&quot;&gt;&lt;font color=&quot;#d2a8ff&quot;&gt;init_weight&lt;/font&gt;&lt;/a&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px; margin-left: 8px;&quot;&gt;&lt;a style=&quot;background-color: rgb(0, 0, 0);&quot; href=&quot;data:page/id,uzz6QVAgYd6YLyIYvyyA&quot;&gt;&lt;font color=&quot;#d2a8ff&quot;&gt;setup&lt;/font&gt;&lt;/a&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=ui-monospace, SFMono-Regular, &quot;SF Mono&quot;, Menlo, Consolas, &quot;Liberation Mono&quot;, monospace;html=1;strokeColor=#003366;shadow=1;fillColor=#D4E1F5;fontColor=#003366" parent="1" vertex="1">
          <mxGeometry x="40" y="240" width="260" height="390" as="geometry" />
        </mxCell>
        <mxCell id="_2fx6bxfBk6hNO2VCk2_-2" value="&lt;h1&gt;Сериализация&lt;/h1&gt;&lt;p&gt;Как сделать понятное верхнеуровневое API для сохранения \ загрузки сетки из файла?&amp;nbsp;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="580" y="10" width="190" height="120" as="geometry" />
        </mxCell>
        <mxCell id="FIbBD87SsG-cr0epnL6o-1" value="&lt;h1&gt;Общие вопросы&lt;/h1&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontSize=13;" parent="1" vertex="1">
          <mxGeometry x="1050" y="10" width="270" height="120" as="geometry" />
        </mxCell>
        <mxCell id="FIbBD87SsG-cr0epnL6o-2" value="&lt;ul&gt;&lt;li&gt;Функция печати тензора как numpy&lt;/li&gt;&lt;li&gt;Как обращаться к измерению ниже по индексу? (доступен только slice), можно по-другому? нужно?&amp;nbsp;&lt;/li&gt;&lt;li&gt;Нужен ли холдер для значений нейронов и градиентов слоя (&lt;b&gt;node-&amp;gt;get_data(), node-&amp;gt;get_grad()&lt;/b&gt;), в старой версии это были &lt;i&gt;m_z, m_a, m_din&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i&gt;Edge &lt;/i&gt;это структура, которая хранит состояния слоя до вычисления и после. Зачем это нужно? Можно ли сделать проще?&lt;/li&gt;&lt;/ul&gt;" style="text;strokeColor=none;fillColor=none;html=1;whiteSpace=wrap;verticalAlign=middle;overflow=hidden;fontSize=13;" parent="1" vertex="1">
          <mxGeometry x="1030" y="50" width="390" height="170" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="acLyr5f8MV2qwVlqdKkI" name="layer::forward">
    <mxGraphModel dx="1300" dy="802" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="583" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="Bmp8aAYqUwf2WiW74yyu-1" value="&lt;font style=&quot;font-size: 17px;&quot;&gt;В tiny-dnn метод &lt;b&gt;forward&lt;/b&gt;() используются для создания контейнера, в который кладутся данные из кучи вычислительного графика -&amp;gt; они преобразуются в интерфейс слоя... Зачем это нужно? Хз&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="3" width="580" height="90" as="geometry" />
        </mxCell>
        <mxCell id="Bmp8aAYqUwf2WiW74yyu-2" value="С большой доли вероятности данный метод мне не нужен, т.к &lt;b&gt;Eigen&lt;/b&gt; сам беспокоится об различных контейнерах.&lt;br&gt;&lt;br&gt;//&lt;b&gt;TODO&lt;/b&gt;: подумать про то, как организовать работу с несколькими измерениями TensorBase объектов. Предполагаемое решение - в методе forward() преобразовать данные к 4 мерному тензору. forward_propagation &amp;amp;&amp;amp; back_propagation будут работать только с 4 мерными тензорами, уменьшая размерность до нужного масштаба. Тогда появляется вопрос, как инициализировать слой?&amp;nbsp;&lt;br&gt;//&lt;b&gt;TODO&lt;/b&gt;: разработать логику аллоцирования памяти и преобразования входных данных в 4 мерный тензор и обратно.&lt;br&gt;//&lt;b&gt;THINK&lt;/b&gt;: можно ли в этом методе делать выравнивание? и подавать эти данные дальше для вычислений?&amp;nbsp;&lt;br&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;	&lt;/span&gt;Если данные выравнивать, они уже где то должны храниться до выравнивания. Где? Мб Edge-Node структуры?" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=17;" parent="1" vertex="1">
          <mxGeometry x="2" y="100" width="580" height="340" as="geometry" />
        </mxCell>
        <mxCell id="uD0cILj6ARvdNZH_asx5-5" value="" style="endArrow=none;html=1;edgeStyle=orthogonalEdgeStyle;rounded=0;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="280" y="610" as="sourcePoint" />
            <mxPoint x="280" y="730" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="uD0cILj6ARvdNZH_asx5-6" value="parent" style="edgeLabel;resizable=0;html=1;align=left;verticalAlign=bottom;fontSize=13;" parent="uD0cILj6ARvdNZH_asx5-5" connectable="0" vertex="1">
          <mxGeometry x="-1" relative="1" as="geometry">
            <mxPoint x="10" y="20" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="uD0cILj6ARvdNZH_asx5-7" value="child" style="edgeLabel;resizable=0;html=1;align=right;verticalAlign=bottom;fontSize=14;" parent="uD0cILj6ARvdNZH_asx5-5" connectable="0" vertex="1">
          <mxGeometry x="1" relative="1" as="geometry">
            <mxPoint x="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="uD0cILj6ARvdNZH_asx5-9" value="&lt;p style=&quot;margin:0px;margin-top:4px;text-align:center;text-decoration:underline;&quot;&gt;&lt;b&gt;layer::forward&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:8px;&quot;&gt;аллокация этих контейнеров происходит только один раз, при первом проходе сетки&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:8px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;fwd_in_data&amp;nbsp; &amp;nbsp;&lt;span style=&quot;&quot;&gt; &lt;/span&gt;= Tensor_4D().allocate()&amp;nbsp; &amp;nbsp;// создать необходимые измерения. см.&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: rgb(43, 43, 43); color: rgb(169, 183, 198); font-family: &amp;quot;JetBrains Mono&amp;quot;, monospace;&quot;&gt;create_new_dim&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:8px;&quot;&gt;fwd_out_data&amp;nbsp; = Tensor_4D().allocate()&amp;nbsp; &amp;nbsp;// аналогично&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:8px;&quot;&gt;alligned_fwd_in_data&amp;nbsp; &amp;nbsp;= AllignedTensor_4D(...)&amp;nbsp;&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:8px;&quot;&gt;alligned_fwd_out_data = AllignedTensor_4D(...)&amp;nbsp;&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:8px;&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;" parent="1" vertex="1">
          <mxGeometry y="470" width="580" height="100" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="P51iXEZZl-BP7aw9WZGj" name="layer::forward_propagation">
    <mxGraphModel dx="1859" dy="1146" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="583" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="9vZ8QekkStvvB2-BGn0U" name="layer::backward">
    <mxGraphModel dx="1302" dy="802" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="583" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="YzGOiIOgP3fO_uxTNOQc" name="layer::back_propagation">
    <mxGraphModel dx="1301" dy="802" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="583" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="imFPhnd7Cz6RNdqDAHEO" name="layer::weight_init">
    <mxGraphModel dx="1301" dy="802" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="583" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="1ntwXYWYcS74xLM6uAJB" name="layer::update_weight">
    <mxGraphModel dx="1301" dy="802" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="583" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="p6dzrHT5QFA6u9v4Chr_" name="layer::init_weight">
    <mxGraphModel dx="1301" dy="802" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="583" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="uzz6QVAgYd6YLyIYvyyA" name="layer::setup">
    <mxGraphModel dx="1301" dy="802" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="583" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
